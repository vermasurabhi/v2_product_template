<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Excel Template Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .section h3 {
            margin-top: 0;
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        .field-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .field-item {
            background: white;
            padding: 8px;
            border-radius: 3px;
            font-size: 12px;
            border-left: 3px solid #3498db;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .button-container {
            text-align: center;
            margin-top: 30px;
        }
        .info {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .note {
            font-style: italic;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Dynamic Product Excel Template Generator</h1>
        
        <div class="info">
            <strong>üìã Template Features:</strong>
            <ul>
                <li>Flattens all nested JSON structures into Excel columns</li>
                <li>Excludes image data and auto-generated metadata</li>
                <li>Supports multiple product variants and options</li>
                <li>Ready for bulk upload scripting</li>
            </ul>
        </div>

        <div class="section">
            <h3>üè∑Ô∏è Basic Product Information</h3>
            <div class="field-grid">
                <div class="field-item">name</div>
                <div class="field-item">offers</div>
                <div class="field-item">price</div>
                <div class="field-item">salePrice</div>
                <div class="field-item">onDiscount</div>
                <div class="field-item">type</div>
                <div class="field-item">slug</div>
                <div class="field-item">sku</div>
                <div class="field-item">prod_desc</div>
            </div>
        </div>

        <div class="section">
            <h3>üéØ Product Attributes</h3>
            <div class="field-grid">
                <div class="field-item">comfort (pipe-separated)</div>
                <div class="field-item">height (pipe-separated)</div>
                <div class="field-item">size (pipe-separated)</div>
                <div class="field-item">tags (pipe-separated)</div>
                <div class="field-item">Category</div>
                <div class="field-item">InStock</div>
            </div>
        </div>

        <div class="section">
            <h3>üìñ Product Description Tabs</h3>
            <div class="field-grid">
                <div class="field-item">prodDesc1_title</div>
                <div class="field-item">prodDesc1_tab1_title</div>
                <div class="field-item">prodDesc1_tab1_label1</div>
                <div class="field-item">prodDesc1_tab1_value1</div>
                <div class="field-item">prodDesc1_tab1_label2</div>
                <div class="field-item">prodDesc1_tab1_value2</div>
                <div class="field-item">prodDesc1_tab1_label3</div>
                <div class="field-item">prodDesc1_tab1_value3</div>
                <div class="field-item">prodDesc1_tab2_title</div>
                <div class="field-item">prodDesc1_tab2_label1</div>
                <div class="field-item">prodDesc1_tab2_value1</div>
                <div class="field-item">prodDesc1_tab2_label2</div>
                <div class="field-item">prodDesc1_tab2_value2</div>
                <div class="field-item">prodDesc1_tab3_title</div>
                <div class="field-item">prodDesc1_tab3_label1</div>
                <div class="field-item">prodDesc1_tab3_value1</div>
            </div>
        </div>

        <div class="section">
            <h3>üìã Product Details Tabs</h3>
            <div class="field-grid">
                <div class="field-item">prodDesc2_title</div>
                <div class="field-item">prodDesc2_tab1_title</div>
                <div class="field-item">prodDesc2_tab1_label1</div>
                <div class="field-item">prodDesc2_tab1_value1</div>
                <div class="field-item">prodDesc2_tab1_label2</div>
                <div class="field-item">prodDesc2_tab1_value2</div>
                <div class="field-item">prodDesc2_tab1_label3</div>
                <div class="field-item">prodDesc2_tab1_value3</div>
                <div class="field-item">prodDesc2_tab1_label4</div>
                <div class="field-item">prodDesc2_tab1_value4</div>
                <div class="field-item">prodDesc2_tab1_label5</div>
                <div class="field-item">prodDesc2_tab1_value5</div>
                <div class="field-item">prodDesc2_tab2_title</div>
                <div class="field-item">prodDesc2_tab2_label1</div>
                <div class="field-item">prodDesc2_tab2_value1</div>
                <div class="field-item">prodDesc2_tab2_label2</div>
                <div class="field-item">prodDesc2_tab2_value2</div>
                <div class="field-item">prodDesc2_tab2_label3</div>
                <div class="field-item">prodDesc2_tab2_value3</div>
                <div class="field-item">prodDesc2_tab2_label4</div>
                <div class="field-item">prodDesc2_tab2_value4</div>
                <div class="field-item">prodDesc2_tab3_title</div>
                <div class="field-item">prodDesc2_tab3_label1</div>
                <div class="field-item">prodDesc2_tab3_value1</div>
            </div>
        </div>

        <div class="section">
            <h3>‚ùì FAQ Section (Up to 5 FAQs)</h3>
            <div class="field-grid">
                <div class="field-item">faq1_question</div>
                <div class="field-item">faq1_answer</div>
                <div class="field-item">faq2_question</div>
                <div class="field-item">faq2_answer</div>
                <div class="field-item">faq3_question</div>
                <div class="field-item">faq3_answer</div>
                <div class="field-item">faq4_question</div>
                <div class="field-item">faq4_answer</div>
                <div class="field-item">faq5_question</div>
                <div class="field-item">faq5_answer</div>
            </div>
        </div>

        <div class="section">
            <h3>‚≠ê Product Features</h3>
            <div class="field-grid">
                <div class="field-item">feature1_heading</div>
                <div class="field-item">feature1_desc</div>
                <div class="field-item">feature2_heading</div>
                <div class="field-item">feature2_desc</div>
                <div class="field-item">feature3_heading</div>
                <div class="field-item">feature3_desc</div>
                <div class="field-item">feature4_heading</div>
                <div class="field-item">feature4_desc</div>
            </div>
        </div>

        <div class="section">
            <h3>üîó Product Group & Variants (Up to 10 variants)</h3>
            <div class="field-grid">
                <div class="field-item">product_group_name</div>
                <div class="field-item">variant1_size</div>
                <div class="field-item">variant1_color</div>
                <div class="field-item">variant1_sku</div>
                <div class="field-item">variant1_slug</div>
                <div class="field-item">variant2_size</div>
                <div class="field-item">variant2_color</div>
                <div class="field-item">variant2_sku</div>
                <div class="field-item">variant2_slug</div>
                <div class="field-item">variant3_size</div>
                <div class="field-item">variant3_color</div>
                <div class="field-item">variant3_sku</div>
                <div class="field-item">variant3_slug</div>
                <div class="field-item">... (up to variant10)</div>
            </div>
        </div>

        <div class="button-container">
            <button onclick="generateTemplate()">üì• Download Excel Template</button>
            <button onclick="generateSampleData()">üìÑ Download with Sample Data</button>
        </div>

        <div class="note">
            <p><strong>üìù Notes:</strong></p>
            <ul>
                <li><strong>Simple Text:</strong> Just type normal text in each field</li>
                <li><strong>Multiple Values:</strong> Use "|" to separate (e.g., "soft|comfortable|breathable")</li>
                <li><strong>Label-Value Pairs:</strong> Each label gets its own column with corresponding value column</li>
                <li><strong>Empty Fields:</strong> Leave blank if not applicable - your script will handle nulls</li>
                <li><strong>Images:</strong> Will be handled separately through your upload script</li>
            </ul>
        </div>
    </div>

    <script>
        function generateTemplate() {
            const headers = [
                // Basic Information
                'name', 'offers', 'price', 'salePrice', 'onDiscount', 'type', 'slug', 'sku', 'prod_desc',
                
                // Attributes (pipe-separated)
                'comfort', 'height', 'size', 'tags', 'Category', 'InStock',
                
                // Product Description 1 - Simplified
                'prodDesc1_title', 
                'prodDesc1_tab1_title', 
                'prodDesc1_tab1_label1', 'prodDesc1_tab1_value1',
                'prodDesc1_tab1_label2', 'prodDesc1_tab1_value2',
                'prodDesc1_tab1_label3', 'prodDesc1_tab1_value3',
                'prodDesc1_tab2_title',
                'prodDesc1_tab2_label1', 'prodDesc1_tab2_value1',
                'prodDesc1_tab2_label2', 'prodDesc1_tab2_value2',
                'prodDesc1_tab3_title',
                'prodDesc1_tab3_label1', 'prodDesc1_tab3_value1',
                
                // Product Description 2 - Simplified
                'prodDesc2_title',
                'prodDesc2_tab1_title',
                'prodDesc2_tab1_label1', 'prodDesc2_tab1_value1',
                'prodDesc2_tab1_label2', 'prodDesc2_tab1_value2',
                'prodDesc2_tab1_label3', 'prodDesc2_tab1_value3',
                'prodDesc2_tab1_label4', 'prodDesc2_tab1_value4',
                'prodDesc2_tab1_label5', 'prodDesc2_tab1_value5',
                'prodDesc2_tab2_title',
                'prodDesc2_tab2_label1', 'prodDesc2_tab2_value1',
                'prodDesc2_tab2_label2', 'prodDesc2_tab2_value2',
                'prodDesc2_tab2_label3', 'prodDesc2_tab2_value3',
                'prodDesc2_tab2_label4', 'prodDesc2_tab2_value4',
                'prodDesc2_tab3_title',
                'prodDesc2_tab3_label1', 'prodDesc2_tab3_value1',
                
                // FAQ - Simplified
                'faq1_question', 'faq1_answer',
                'faq2_question', 'faq2_answer',
                'faq3_question', 'faq3_answer',
                'faq4_question', 'faq4_answer',
                'faq5_question', 'faq5_answer',
                
                // Features (up to 4 features)
                'feature1_heading', 'feature1_desc',
                'feature2_heading', 'feature2_desc',
                'feature3_heading', 'feature3_desc',
                'feature4_heading', 'feature4_desc',
                
                // Product Group & Variants - Simplified
                'product_group_name',
                'variant1_size', 'variant1_color', 'variant1_sku', 'variant1_slug',
                'variant2_size', 'variant2_color', 'variant2_sku', 'variant2_slug',
                'variant3_size', 'variant3_color', 'variant3_sku', 'variant3_slug',
                'variant4_size', 'variant4_color', 'variant4_sku', 'variant4_slug',
                'variant5_size', 'variant5_color', 'variant5_sku', 'variant5_slug',
                'variant6_size', 'variant6_color', 'variant6_sku', 'variant6_slug',
                'variant7_size', 'variant7_color', 'variant7_sku', 'variant7_slug',
                'variant8_size', 'variant8_color', 'variant8_sku', 'variant8_slug',
                'variant9_size', 'variant9_color', 'variant9_sku', 'variant9_slug',
                'variant10_size', 'variant10_color', 'variant10_sku', 'variant10_slug'
            ];

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([headers]);
            
            // Set column widths
            ws['!cols'] = headers.map(() => ({wch: 25}));
            
            XLSX.utils.book_append_sheet(wb, ws, "Product Template");
            XLSX.writeFile(wb, "product_upload_template_simplified.xlsx");
        }

        function generateSampleData() {
            const headers = [
                'name', 'offers', 'price', 'salePrice', 'onDiscount', 'type', 'slug', 'sku', 'prod_desc',
                'comfort', 'height', 'size', 'tags', 'Category', 'InStock',
                'prodDesc1_title', 'prodDesc1_tab1_title', 
                'prodDesc1_tab1_label1', 'prodDesc1_tab1_value1',
                'prodDesc1_tab1_label2', 'prodDesc1_tab1_value2',
                'prodDesc1_tab1_label3', 'prodDesc1_tab1_value3',
                'prodDesc1_tab2_title',
                'prodDesc1_tab2_label1', 'prodDesc1_tab2_value1',
                'prodDesc1_tab2_label2', 'prodDesc1_tab2_value2',
                'prodDesc1_tab3_title',
                'prodDesc1_tab3_label1', 'prodDesc1_tab3_value1',
                'prodDesc2_title', 'prodDesc2_tab1_title',
                'prodDesc2_tab1_label1', 'prodDesc2_tab1_value1',
                'prodDesc2_tab1_label2', 'prodDesc2_tab1_value2',
                'prodDesc2_tab1_label3', 'prodDesc2_tab1_value3',
                'prodDesc2_tab1_label4', 'prodDesc2_tab1_value4',
                'prodDesc2_tab1_label5', 'prodDesc2_tab1_value5',
                'prodDesc2_tab2_title',
                'prodDesc2_tab2_label1', 'prodDesc2_tab2_value1',
                'prodDesc2_tab2_label2', 'prodDesc2_tab2_value2',
                'prodDesc2_tab2_label3', 'prodDesc2_tab2_value3',
                'prodDesc2_tab2_label4', 'prodDesc2_tab2_value4',
                'prodDesc2_tab3_title',
                'prodDesc2_tab3_label1', 'prodDesc2_tab3_value1',
                'faq1_question', 'faq1_answer',
                'faq2_question', 'faq2_answer',
                'faq3_question', 'faq3_answer',
                'faq4_question', 'faq4_answer',
                'faq5_question', 'faq5_answer',
                'feature1_heading', 'feature1_desc',
                'feature2_heading', 'feature2_desc',
                'feature3_heading', 'feature3_desc',
                'feature4_heading', 'feature4_desc',
                'product_group_name',
                'variant1_size', 'variant1_color', 'variant1_sku', 'variant1_slug',
                'variant2_size', 'variant2_color', 'variant2_sku', 'variant2_slug',
                'variant3_size', 'variant3_color', 'variant3_sku', 'variant3_slug'
            ];

            const sampleData = [
                // Basic info
                'GADDA CO 100% Waterproof Premium Cotton Feel Mattress Protector Twin Bed 75x48 Inch',
                'b', 1399, 569, false, 'mattress-protector',
                'gadda-co-100-waterproof-premium-cotton-feel-mattress-protector-twin-bed-75x48-inch',
                'GC-6139-W',
                'GADDA CO 100% Waterproof Premium Cotton Feel Mattress Protector',
                
                // Attributes
                'soft', '', 'double', '', null, null,
                
                // ProdDesc1
                'Product Description', 'Benefits',
                'High Quality Mattress Cover', 'Free of pvc, vinyl, phthalates and fire retardants',
                '', '', '', '',
                'Protection',
                'Dust Mites Protection', 'Protects against dust mites, allergens, and bacteria',
                '', '',
                'Waterproof',
                '100% Waterproof', 'Complete waterproof protection',
                
                // ProdDesc2
                'Product Details', 'Material & Care',
                'Fabric type', 'Cotton Terry',
                'Colour', 'White',
                'Closure Type', 'Pull On',
                'Water Resistance Level', 'Waterproof',
                'Product Care Instructions', 'Machine wash / Hand wash',
                'Dimensions & Weight',
                'Product Dimensions', '78"x60"',
                'Thread Count', '250',
                'Item Weight', '460 g',
                'Item Dimensions LxWxH', '190 x 122 x 0.2 Centimeters',
                'Return & Refund',
                'Return Policy', '7 Days',
                
                // FAQ
                'What is in the box?', '1 Mattress Protector',
                'Is it machine washable?', 'Yes, machine washable',
                'What sizes are available?', 'Multiple sizes from single to king',
                '', '', '', '',
                
                // Features
                '100 WATERPROOF COTTON MATTRESS PROTECTOR',
                'Safeguard your mattress with GADDA CO Premium reusable waterproof mattress protector',
                'HYPOALLERGENIC & SAFE',
                'Protects against dust mites, allergens, and bacteria, making it ideal for sensitive skin',
                'PREMIUM COTTON FEEL',
                'Made with a super soft, breathable terry fabric for a luxurious cotton feel',
                'GADDA CO BED PROTECTOR',
                'Perfect for healthy sleep, pregnancy comfort, kids playful needs, pet-friendly durability',
                
                // Product group
                'Cotton Feel Mattress Protector',
                'd78"x84"', 'Blue', 'GC-6120-B', 'gadda-co-mattress-protector-king-blue',
                'd78"x84"', 'White', 'GC-6120-W', 'gadda-co-mattress-protector-king-white',
                'd72"x36"', 'Blue', 'GC-6121-B', 'gadda-co-mattress-protector-single-blue'
            ];

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([headers.slice(0, sampleData.length), sampleData]);
            
            // Set column widths
            ws['!cols'] = headers.map(() => ({wch: 30}));
            
            XLSX.utils.book_append_sheet(wb, ws, "Product Template");
            XLSX.writeFile(wb, "product_upload_template_simplified_with_sample.xlsx");
        }
    </script>
</body>
</html>
